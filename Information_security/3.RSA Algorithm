import math
from sympy import mod_inverse
# Step 1: Choose two prime numbers
p = int(input(&quot;Enter a prime number p: &quot;))
q = int(input(&quot;Enter a prime number q: &quot;))
# Step 2: Calculate n
n = p * q
print(&quot;n =&quot;, n)
# Step 3: Compute Euler&#39;s Totient function
phi = (p - 1) * (q - 1)
# Step 4: Choose e such that 1 &lt; e &lt; phi and gcd(e, phi) = 1
e = 2
while e &lt; phi:
if math.gcd(e, phi) == 1:
break
e += 1
print(&quot;e =&quot;, e)
# Step 5: Calculate d, modular multiplicative inverse of e mod phi
d = mod_inverse(e, phi)
print(&quot;d =&quot;, d)
# Step 6: Display public and private keys
print(f&quot;Public key: ({e}, {n})&quot;)
print(f&quot;Private key: ({d}, {n})&quot;)
# Step 7: Input message (as integer)

msg = int(input(&quot;Enter the message (as a number): &quot;))
print(f&quot;Original message: {msg}&quot;)
# Step 8: Encryption
C = pow(msg, e, n)
print(f&quot;Encrypted message: {C}&quot;)
# Step 9: Decryption
M = pow(C, d, n)
print(f&quot;Decrypted message: {M}&quot;)
